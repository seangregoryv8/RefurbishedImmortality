<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video</title>
    <link rel="stylesheet" href="../main.css">
    <link rel="stylesheet" href="./stylesheet/overlay.css">
    <link rel="stylesheet" href="./stylesheet/glitch.css"/>
</head>
<body>
    <div id='vhs_overlay_div'>
        <img id="vhs_overlay">
    </div>
    <div id="leftbar"></div>
    <div id="rightbar"></div>

    <div id="all">
        <p id="control"></p>
        <p id="record" style="visibility: hidden;">REC
            <font color="red">‚è∫</font>
        </p>

        <div id="centerVideo">
            <video id="mainVideo" style="visibility: hidden;"></video>
        </div>
    
        <p id="time"></p>
        <p id="currentTime"></p>
        <p id="currentDate"></p>

        <div id="volume">
            <p id="volumeControl">VOL</p>
            <p id="volumeLevel">||||||||||</p>
        </div>
    </div>

    <script type="module" src="./src/main.js"></script>
    <script type="text/javascript">
        var source = document.createElement('source');
        var url = parent.document.URL;
        if (url.indexOf('?') == -1)
        {
            document.location.href = "../vhs_menu/menu.html"
        }
        var t = url.substring(url.indexOf('?'), url.length);
        var r = t.substring(t.indexOf('=') + 1, t.length);

        source.src = "../tapes/" + r;
        source.type = "video/mp4";

        document.getElementById("mainVideo").appendChild(source);

        const newURL = url.substring(0, url.indexOf('?'));
        const nextTitle = 'icantbreatheicantbreatheicantbreatheicantbreathe';
        const nextState = { additionalInformation: 'Updated' };
        
        window.history.replaceState(nextState, nextTitle, newURL);

        addEventListener('beforeunload', (event) => 
        {
            document.location.href = url;
            window.history.replaceState(nextState, nextTitle, url);
        })
    </script>
</body>
</html>